"use strict";var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Sortable=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.parent,i=e.links,s=void 0===i?document.querySelectorAll("[data-sjslink]"):i,a=e.active,r=void 0===a?"is-active":a,o=e.margin,l=void 0===o?20:o,u=e.responsive,c=void 0===u?{980:{columns:3},480:{columns:2},0:{columns:1}}:u,h=e.fadeDuration,d=void 0===h?{in:300,out:0}:h;_classCallCheck(this,t),this.parent=n,this.links=Array.from(s),this.active=r,this.margin=l,this.responsive=c,this.fadeDuration=d,this.elements=Array.from(this.parent.children),this.activeElements=this.elements,this.columns=1,this.dataLink="all",this.winWidth=window.innerWidth,this.init()}return _createClass(t,[{key:"orderelements",value:function(){var t=this,e=this.parent,n=this.activeElements,i=this.columns,s=this.blocWidth,a=(this.responsive,this.margin),r=n.reduce((function(e,n,r){var o=t._sumArrHeight(e,i),l=r%i*(s+a),u=0<=r-i?o[r%i]+a*Math.floor(r/i):0;return n.style.transform="translate3d("+l+"px, "+u+"px, 0)",e.push(n.offsetHeight),e}),[]),o=this._sumArrHeight(r,i),l=Math.max.apply(Math,_toConsumableArray(o))+a*(Math.floor(n.length/i)-1);e.style.height=l+"px"}},{key:"handleFilterClick",value:function(t,e){var n=this;t.preventDefault();var i=this.links,s=this.active;e.dataset.sjslink!==this.dataLink&&(this.dataLink=e.dataset.sjslink,i.forEach((function(t){t.isEqualNode(e)?t.classList.add(s):t.classList.remove(s)})),this._filterElements((function(){n.orderelements()})))}},{key:"resize",value:function(){var t=this;window.addEventListener("resize",(function(){clearTimeout(window.sortableResize),window.sortableResize=setTimeout((function(){t.winWidth=window.innerWidth,t._setBlocWidth((function(){t.orderelements()}))}),500)}))}},{key:"init",value:function(){var t=this,e=this.parent,n=this.links,i=this.active;n.forEach((function(e,n){0===n&&(e.classList.add(i),t.dataLink=e.dataset.sjslink),e.addEventListener("click",(function(n){t.handleFilterClick(n,e)}))})),this._setBlocWidth(),window.addEventListener("load",(function(){t._filterElements((function(){t.orderelements()})),e.style.opacity=1})),this.resize()}},{key:"_setBlocWidth",value:function(t){var e=this.parent,n=this.elements,i=this.margin,s=this.responsive,a=this.columns=this._columnsCount(s).columns,r=this.blocWidth=(e.clientWidth-i*(a-1))/a;n.forEach((function(t){t.style.width=r+"px"})),t&&t()}},{key:"_filterElements",value:function(t){var e=this,n=this.elements,i=this.dataLink,s=this.fadeDuration;this.activeElements=n.filter((function(t){return"all"===i?(e._fadeIn(t,s.in),!0):t.dataset.sjsel!==i?(e._fadeOut(t,s.out),!1):(e._fadeIn(t,s.in),!0)})),t&&t()}},{key:"_sumArrHeight",value:function(t,e){return t.reduce((function(t,n,i){var s=i%e;return t[s]||(t[s]=0),t[s]=t[s]+n,t}),[])}},{key:"_columnsCount",value:function(t){var e=this.winWidth;return Object.entries(t).reduce((function(t,n){return e>n[0]&&n[0]>=Math.max(t.width)?{width:n[0],columns:n[1].columns}:t}),{width:0,columns:4})}},{key:"_fadeIn",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300,n=arguments[2],i=parseFloat(window.getComputedStyle(t,null).getPropertyValue("opacity")),s=16/e;t.style.display="block",requestAnimationFrame((function e(){(i+=s)<=1?(t.style.opacity=i,requestAnimationFrame(e)):(t.style.opacity=1,n&&n())}))}},{key:"_fadeOut",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300,n=arguments[2],i=parseFloat(window.getComputedStyle(t,null).getPropertyValue("opacity")),s=e?16/e:1;requestAnimationFrame((function e(){0<=(i-=s)?(t.style.opacity=i,requestAnimationFrame(e)):(t.style.opacity=0,t.style.display="none",n&&n())}))}}]),t}();HTMLElement.prototype.sortablejs=HTMLElement.prototype.sortablejs||function(t){return new Sortable(_extends({parent:this},t))};